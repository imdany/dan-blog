<!DOCTYPE html>



<html lang="en-US" 
  
    mode="light"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    

    

  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="An Introduction to Geospatial Processing with Spark" />
<meta name="author" content="Daniel González Pérez" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this new era of information, geospatial data is becoming more and more relevant in the Data Engineering and Data Analytics work… but what do we mean when we talk about Geospatial Data?" />
<meta property="og:description" content="In this new era of information, geospatial data is becoming more and more relevant in the Data Engineering and Data Analytics work… but what do we mean when we talk about Geospatial Data?" />
<link rel="canonical" href="https://blog.imdany.io/posts/spark-intro-geospatial-analytics/" />
<meta property="og:url" content="https://blog.imdany.io/posts/spark-intro-geospatial-analytics/" />
<meta property="og:site_name" content="Dan’s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-01-23T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="An Introduction to Geospatial Processing with Spark" />
<meta name="twitter:site" content="@twitter_username" />
<meta name="twitter:creator" content="@Daniel González Pérez" />
<meta name="google-site-verification" content="google_meta_tag_verification" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"https://blog.imdany.io/posts/spark-intro-geospatial-analytics/","headline":"An Introduction to Geospatial Processing with Spark","datePublished":"2021-01-23T00:00:00+00:00","dateModified":"2021-01-23T00:00:00+00:00","author":{"@type":"Person","name":"Daniel González Pérez"},"description":"In this new era of information, geospatial data is becoming more and more relevant in the Data Engineering and Data Analytics work… but what do we mean when we talk about Geospatial Data?","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.imdany.io/posts/spark-intro-geospatial-analytics/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <title>An Introduction to Geospatial Processing with Spark | Dan's Blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Dan's Blog">
<meta name="application-name" content="Dan's Blog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">

  <!-- GA -->
  

  <!-- jsDelivr CDN -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css">

  <!--
  CSS selector for site.
-->

<link rel="stylesheet" href="/assets/css/style.css">


  <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">



  <!-- Manific Popup -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">



  <!-- JavaScript -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>An Introduction to Geospatial Processing with Spark | Dan’s Blog</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="An Introduction to Geospatial Processing with Spark" />
<meta name="author" content="Daniel González Pérez" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this new era of information, geospatial data is becoming more and more relevant in the Data Engineering and Data Analytics work… but what do we mean when we talk about Geospatial Data?" />
<meta property="og:description" content="In this new era of information, geospatial data is becoming more and more relevant in the Data Engineering and Data Analytics work… but what do we mean when we talk about Geospatial Data?" />
<link rel="canonical" href="https://blog.imdany.io/posts/spark-intro-geospatial-analytics/" />
<meta property="og:url" content="https://blog.imdany.io/posts/spark-intro-geospatial-analytics/" />
<meta property="og:site_name" content="Dan’s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-01-23T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="An Introduction to Geospatial Processing with Spark" />
<meta name="twitter:site" content="@twitter_username" />
<meta name="twitter:creator" content="@Daniel González Pérez" />
<meta name="google-site-verification" content="google_meta_tag_verification" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"https://blog.imdany.io/posts/spark-intro-geospatial-analytics/","headline":"An Introduction to Geospatial Processing with Spark","datePublished":"2021-01-23T00:00:00+00:00","dateModified":"2021-01-23T00:00:00+00:00","author":{"@type":"Person","name":"Daniel González Pérez"},"description":"In this new era of information, geospatial data is becoming more and more relevant in the Data Engineering and Data Analytics work… but what do we mean when we talk about Geospatial Data?","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.imdany.io/posts/spark-intro-geospatial-analytics/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


</head>


  <body data-spy="scroll" data-target="#toc">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">

  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" alt="avatar" class="mx-auto">
        
        <img src="/assets/img/avatar1.jpg" alt="avatar" onerror="this.style.display='none'">
      </a>
    </div>

    <div class="site-title mt-3">
      <a href="/">Dan's Blog</a>
    </div>

    <div class="site-subtitle font-italic">A personal blog for sharing some ideas.</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">
    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i>
        <span>ABOUT ME</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center">

    
      

      
      <a href="https://github.com/imdany" aria-label="github"
        
        target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
      

    
      

      
      <a href="https://www.linkedin.com/in/daniel-gonzalez-perez/" aria-label="linkedin"
        
        target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        
        >
        <i class="fas fa-rss"></i>
      </a>
      

    

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper" class="row justify-content-center topbar-down">
  <div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between">
    <span id="breadcrumb">

    

    

      

        
          

        

      

        
        <span>
          
          
          <a href="/">
            Posts
          </a>
        </span>

        

      

        
          <span>An Introduction to Geospatial Processing with Spark</span>

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
      <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i>
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper">
      <div id="main">

        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Add attribute 'hide-bullet' to the checkbox list -->




<!-- images -->



  <!-- add CDN prefix if it exists -->

  

  

  <!-- lazy-load images <https://github.com/ApoorvSaxena/lozad.js#usage> -->

  

  <!-- add image placehoder to prevent layout reflow -->

  

  

  
    
      
      
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  
    

    
    
    

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    
      
      

      

      

    

    

  

  



<!-- Add lang-badge for code snippets -->




<!-- return -->

<div class="row">

  <div id="post-wrapper" class="col-12 col-lg-11 col-xl-8">

    <div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

      <h1 data-toc-skip>An Introduction to Geospatial Processing with Spark</h1>

      <div class="post-meta text-muted d-flex flex-column">
        <!-- Published date and author -->
        <div>
          <span class="semi-bold">
            Daniel González Pérez
          </span>
          <!--
  Date format snippet
  See: /assets/js/_utils/timeage.js
-->





<span class="timeago "
  
    data-toggle="tooltip"
    data-placement="bottom"
    title="Sat, Jan 23, 2021, 12:00 AM +0000"
  

  
  prep="on" >

  
  

  
    Jan 23
  

  <i class="unloaded">2021-01-23T00:00:00+00:00</i>

</span>

        </div>

        <div>
          <!-- lastmod -->
          

          <!-- read time -->
          <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->


<!-- words per minute  -->







<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1041 words">5 min</span>


          <!-- page views -->
          

        </div>

      </div> <!-- .post-meta -->

      <div class="post-content">

        

        <p>In this new era of information, geospatial data is becoming more and more relevant in the Data Engineering and Data Analytics work… but what do we mean when we talk about Geospatial Data?</p>

<p>In this post, I would like to introduce some basic concepts about Geospatial Processing using Spark, one of the most popular data processing frameworks of 2020.
Let’s start with the basics, what is geospatial data?</p>

<div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>Geospatial data is about objects, events or phenomena that have a location 
on the surface of the Earth (let’s not worry about other planets yet… Sorry, Mars Rover)
</pre></td></tr></tbody></table></code></div></div>

<p>And what does this mean in terms of data? Well… We can represent Geospatial data with just a String, and the two most popular formats for doing so are:</p>

<ul>
  <li><strong>GeoJson</strong>: {“geometry”:{“type”:“Polygon”,“coordinates”:[[[100.0, 0.0],[101.0, 0.0],[101.0, 1.0],[100.0, 1.0],[100.0, 0.0]]]}}</li>
  <li><strong>Well-Known Text (WKT)</strong>: POLYGON ((100.0 0.0, 101.0 0.0, 101.0 1.0, 100.0 1.0, 100.0 0.0))</li>
</ul>

<p>The examples above are representing this polygon:</p>

<p><img data-proofer-ignore data-src="/assets/img/posts/2021-01-23-spark-intro-geospatial-analytics/1.png#center" alt="Example image" /></p>

<p>But data as a <strong>String</strong> is not very useful because we would like to apply some spatial operators on them, and doing that with a String can be really hard… hence we use something called a <strong>Geometry Type</strong>. This data type, which is not available in every system, allows us to use spatial operators like Containts, Insersect, and many more:</p>

<p><img data-proofer-ignore data-src="/assets/img/posts/2021-01-23-spark-intro-geospatial-analytics/2.png#center" alt="Example image" /></p>

<p>Of course, we can do that without any Geometry Type, but it’s much easier to do <strong>Intersection of (Polygon A and Polygon B)</strong>, than to code all the math behind that operation.</p>

<h2 id="so-how-can-i-do-all-of-this-in-spark">So… How can I do all of this in Spark?</h2>

<p>Spark doesn’t have a <strong>Geometry Type</strong> embedded, but luckily there are some people out there that have done, and continue doing, that work for us (Thanks open source community!)… So there are a few choices on how to do this:</p>

<ul>
  <li><strong>Use a third-party library</strong>: there are a few options available like GeoSpark, GeoMesa… this is suitable if you can find the transformations that you need there… So don’t reinvent the wheel and use what other people have already developed and tested.</li>
  <li><strong>Wrap an existing core library</strong>: if the available Spark libraries don’t fit your requirements, you can go one level deeper and wrap one of the existing geospatial implementations in Spark. Normally JTS is the most low-level library that you would find. All the others use this one as a starting point. It only provides the data types and some basic operations between geometries. It’s a java library, so if you want to use it with Spark you need to adapt it yourself.</li>
  <li><strong>Implement everything for scratch</strong>: this will probably require years of work…</li>
</ul>

<h3 id="in-this-introduction-im-going-to-show-the-basics-of-geospark">In this introduction I’m going to show the basics of GeoSpark</h3>

<h4 id="and-we-might-go-deeper-in-an-upcoming-post-">…and we might go deeper in an upcoming post :)</h4>

<p>Assuming that you’re working on a Databricks environment, using GeoSpark is straightforward. You just need to add two Maven libraries to your cluster and that’s it:</p>

<p><img data-proofer-ignore data-src="/assets/img/posts/2021-01-23-spark-intro-geospatial-analytics/3.png#center" alt="Example image" /></p>

<p>Once you have the libraries installed, you can open a notebook and start using those geospatial functions! It’s seriously that simple.</p>

<p>Let’s start by defining a table with some geospatial data: (I will be copying the code of the cells here and adding a screenshot of the result)</p>

<div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>// Create a new DataFrame with a column representing geospatial data as strings

val data = Seq(("ID 1", "POLYGON ((0.0 0.0, 10.0 0.0, 10.0 10.0, 0.0 10.0, 0.0 0.0))"),
               ("ID 2", "POLYGON ((5.0 5.0, 15.0 5.0, 15.0 15.0, 5.0 15.0, 5.0 5.0))"),
               ("ID 3", "POLYGON ((16.0 0.0, 20.0 0.0, 20.0 5.0, 16.0 5.0, 16.0 0.0))"))
            .toDF("ID", "geometry")

display(data)
</pre></td></tr></tbody></table></code></div></div>

<p>These rows represent some polygons:</p>

<p><img data-proofer-ignore data-src="/assets/img/posts/2021-01-23-spark-intro-geospatial-analytics/4.png#center" alt="Example image" /></p>

<p>In order to use the UDFs that GeoSpark provides, we can run the following:</p>

<div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>import org.datasyslab.geosparksql.utils.GeoSparkSQLRegistrator

GeoSparkSQLRegistrator.registerAll(spark)
</pre></td></tr></tbody></table></code></div></div>

<p>We need to convert our strings in a proper geometry type, for that we need to do the following:</p>

<div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>val data2 = data.selectExpr("ID", "ST_GeomFromWKT(geometry) as geometry")

// Checking the schema
data2.printSchema
</pre></td></tr></tbody></table></code></div></div>

<p>So now our geometry column is of type <strong>geometry</strong>:</p>

<p><img data-proofer-ignore data-src="/assets/img/posts/2021-01-23-spark-intro-geospatial-analytics/5.png#center" alt="Example image" /></p>

<p>We are ready for running some spatial operations… But to make this easier, let’s create a temporary table so we can run SQL queries.</p>

<div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>data2.createOrReplaceTempView("GeoTable")
</pre></td></tr></tbody></table></code></div></div>

<p>Let’s get the area of each polygon:</p>

<div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>SELECT *, ST_Area(geometry) AS area FROM GeoTable
</pre></td></tr></tbody></table></code></div></div>

<p><img data-proofer-ignore data-src="/assets/img/posts/2021-01-23-spark-intro-geospatial-analytics/6.png#center" alt="Example image" /></p>

<p>Let’s get the Centroid of each polygon:</p>

<div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>SELECT *, ST_Centroid (geometry) AS centroid FROM GeoTable
</pre></td></tr></tbody></table></code></div></div>

<p><img data-proofer-ignore data-src="/assets/img/posts/2021-01-23-spark-intro-geospatial-analytics/7.png#center" alt="Example image" /></p>

<p>Those functions, the ones that you apply directly to the geometry column are called just Functions.</p>

<p>There are other types, like Predicates, that allows you to check conditions between different polygons.</p>

<p>To use them, you need to have at least two geometries, so let’s get to that situation by creating a new table:</p>

<div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>val data3 = Seq(("ID 1", "POLYGON ((0.0 0.0, 10.0 0.0, 10.0 10.0, 0.0 10.0, 0.0 0.0))", "ID 2", "POLYGON ((5.0 5.0, 15.0 5.0, 15.0 15.0, 5.0 15.0, 5.0 5.0))"),
                ("ID 1", "POLYGON ((0.0 0.0, 10.0 0.0, 10.0 10.0, 0.0 10.0, 0.0 0.0))", "ID 3", "POLYGON ((16.0 0.0, 20.0 0.0, 20.0 5.0, 16.0 5.0, 16.0 0.0))"),
                ("ID 2", "POLYGON ((5.0 5.0, 15.0 5.0, 15.0 15.0, 5.0 15.0, 5.0 5.0))", "ID 1", "POLYGON ((0.0 0.0, 10.0 0.0, 10.0 10.0, 0.0 10.0, 0.0 0.0))"),
                ("ID 2", "POLYGON ((5.0 5.0, 15.0 5.0, 15.0 15.0, 5.0 15.0, 5.0 5.0))", "ID 3", "POLYGON ((16.0 0.0, 20.0 0.0, 20.0 5.0, 16.0 5.0, 16.0 0.0))")
               ).toDF("ID1", "geometry1", "ID2", "geometry2")

val data4 = data3.selectExpr("ID1", "ST_GeomFromWKT(geometry1) as geometry1", "ID2", "ST_GeomFromWKT(geometry2) as geometry2")

data4.createOrReplaceTempView("GeoTable2")
</pre></td></tr></tbody></table></code></div></div>

<p><img data-proofer-ignore data-src="/assets/img/posts/2021-01-23-spark-intro-geospatial-analytics/8.png#center" alt="Example image" /></p>

<p>With this new DataFrame we can run a few Spatial Queries to check for some conditions, like for example:</p>

<p>Checking if two geometries intersect each other.</p>

<p>Checking if the geometry is within other.</p>

<div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>SELECT ID1, 
       ID2, 
       ST_Intersects(geometry1, geometry2)AS Intersects,
       ST_Within(geometry1, geometry2)AS Within
FROM GeoTable2
</pre></td></tr></tbody></table></code></div></div>

<p><img data-proofer-ignore data-src="/assets/img/posts/2021-01-23-spark-intro-geospatial-analytics/9.png#center" alt="Example image" /></p>

<p>You can see that using Geospark can be really easy thanks to its SQL API.</p>

<p>In future posts, I will go deeper into more geospatial processing.</p>

<p>Thanks for reading!</p>


      </div>

      <div class="post-tail-wrapper text-muted">

        <!-- categories -->
        
        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw mr-1"></i>
          
            <a href='/categories/spark/'>Spark</a>,
            <a href='/categories/data-engineer/'>Data Engineer</a>,
            <a href='/categories/geospatial/'>Geospatial</a>
        </div>
        

        <!-- tags -->
        
        <div class="post-tags">
          <i class="fa fa-tags fa-fw mr-1"></i>
          
          <a href="/tags/spark/"
            class="post-tag no-text-decoration" >Spark</a>
          
          <a href="/tags/analytics/"
            class="post-tag no-text-decoration" >Analytics</a>
          
          </div>
        

        <div class="post-tail-bottom
          d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
          
          <div class="license-wrapper">
            This post is licensed under
            <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>
            by the author.
          </div>
          

          <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    

    
      
        <a href="https://twitter.com/intent/tweet?text=An Introduction to Geospatial Processing with Spark - Dan's Blog&url=https://blog.imdany.io/posts/spark-intro-geospatial-analytics/" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://www.facebook.com/sharer/sharer.php?title=An Introduction to Geospatial Processing with Spark - Dan's Blog&u=https://blog.imdany.io/posts/spark-intro-geospatial-analytics/" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://blog.imdany.io/posts/spark-intro-geospatial-analytics/" data-toggle="tooltip" data-placement="top"
          title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin">
          <i class="fa-fw fab fa-linkedin"></i>
        </a>
    

    <i class="fa-fw fas fa-link small" onclick="copyLink()"
        data-toggle="tooltip" data-placement="top" title="Copy link"></i>

  </span>
</div>


        </div><!-- .post-tail-bottom -->

      </div><!-- div.post-tail -->

    </div> <!-- .post -->


  </div> <!-- #post-wrapper -->

  

  


 <!--
  The Pannel on right side (Desktop views)
-->

<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">

  
    <!-- BS-toc.js will be loaded at medium priority -->
    <script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>
    <div id="toc-wrapper" class="pl-0 pr-4 mb-5">
      <span class="pl-3 pt-2 mb-2">Contents</span>
      <nav id="toc" data-toggle="toc"></nav>
    </div>
  

</div> <!-- #panel-wrapper -->

  
</div> <!-- .row -->

<div class="row">
  <div class="col-12 col-lg-11 col-xl-8">
    <div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">

    <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <span class="btn btn-outline-primary disabled"
    prompt="Older">
    <p>-</p>
  </span>
  

  
  <a href="/posts/spark-should-use-catalyst-expressions/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>Why you should start writing Spark Custom Native Functions</p>
  </a>
  

</div>


    

    </div> <!-- #post-extend-wrapper -->

  </div> <!-- .col-* -->

</div> <!-- .row -->



        <!--
  The Footer
-->

<footer class="d-flex w-100 justify-content-center">
  <div class="d-flex justify-content-between align-items-center">
    <div class="footer-left">
      <p class="mb-0">
        © 2021
        <a href="https://github.com/imdany">Dan</a>.
        
        <span data-toggle="tooltip" data-placement="top"
          title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
        
      </p>
    </div>

    <div class="footer-right">
      <p class="mb-0">
        Powered by
        <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>
        with
        <a href="https://github.com/cotes2020/jekyll-theme-chirpy"
          target="_blank" rel="noopener">Chirpy</a>
        theme.
      </p>
    </div>

  </div> <!-- div.d-flex -->
</footer>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      <h4 class="text-muted mb-4">Trending Tags</h4>

      















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



      
        
        <a class="post-tag" href="/tags/spark/">Spark</a>
      
        
        <a class="post-tag" href="/tags/analytics/">Analytics</a>
      
        
        <a class="post-tag" href="/tags/performance/">Performance</a>
      

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="https://blog.imdany.io{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No result founds.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


    <!--
  JS selector for site.
-->

<!-- common -->

<script async src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script>



<!-- layout specified -->


  



  <!-- image lazy-loading & popup -->
  <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script>





<script defer src="/assets/js/dist/post.min.js"></script>




  </body>

</html>

